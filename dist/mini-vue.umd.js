var et=Object.defineProperty;var tt=(c,p,T)=>p in c?et(c,p,{enumerable:!0,configurable:!0,writable:!0,value:T}):c[p]=T;var _=(c,p,T)=>(tt(c,typeof p!="symbol"?p+"":p,T),T);(function(c,p){typeof exports=="object"&&typeof module!="undefined"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(c=typeof globalThis!="undefined"?globalThis:c||self,p(c.MiniVue={}))})(this,function(c){"use strict";function p(e,t){e.props=t||{}}const T=Object.assign,m=e=>typeof e=="object"&&e!==null,x=(e,t)=>!Object.is(e,t),k=e=>{throw new Error(e)},ee=e=>/^on[A-Z]/.test(e),g=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),te=e=>e.charAt(0).toUpperCase()+e.slice(1),ne=e=>e.split("-").map(t=>te(t)).join(""),re=e=>e?`on${ne(e)}`:"",A={},oe={$el:e=>e.vnode.el,$slots:e=>e.slots},se={get({_:e},t){const{setupState:n,props:r}=e;if(g(n,t))return n[t];if(g(r,t))return r[t];const u=oe[t];if(u)return u(e)}};function ce(e,t,...n){const{props:r}=e,u=re(t),l=r[u];l&&l(...n)}var h=(e=>(e[e.ELEMENT=1]="ELEMENT",e[e.STATEFUL_COMPONENT=2]="STATEFUL_COMPONENT",e[e.TEXT_CHILDREN=4]="TEXT_CHILDREN",e[e.ARRAY_CHILDREN=8]="ARRAY_CHILDREN",e[e.SLOT_CHILDREN=16]="SLOT_CHILDREN",e))(h||{});function ie(e,t){e.vnode.shapeFlag&h.SLOT_CHILDREN&&ue(t,e.slots)}function ue(e,t){if(m(e))for(const n in e){const r=e[n];t[n]=u=>fe(r(u))}}function fe(e){return Array.isArray(e)?e:[e]}let v,N;class M{constructor(t,n){_(this,"_fn");_(this,"deps",[]);_(this,"active",!0);_(this,"onStop");this.scheduler=n,this._fn=t}run(){if(!this.active)return this._fn();v=this,N=!0;const t=this._fn();return N=!1,t}stop(){this.active&&(this.onStop&&this.onStop(),le(this),this.active=!1)}}function le(e){e.deps.forEach(t=>{t.delete(e)}),e.deps.length=0}const C=new WeakMap;function P(){return N&&v!==void 0}function ae(e,t){if(!P())return;let n=C.get(e);n||(n=new Map,C.set(e,n));let r=n.get(t);r||(r=new Set,n.set(t,r)),D(r)}function D(e){e.has(v)||(e.add(v),v.deps.push(e))}function pe(e,t){const n=C.get(e);if(!n)throw new Error(`not found ${e}`);const r=n.get(t);if(!r)throw new Error(`not found ${t} in ${e}`);H(r)}function H(e){for(const t of e)t.scheduler?t.scheduler():t.run()}function de(e,t){const n=new M(e,t==null?void 0:t.scheduler);T(n,t),n.run();const r=n.run.bind(n);return r.effect=n,r}const _e=I(),he=j(),Ee=I(!0),Te=j(!0),Re=I(!0,!0);function I(e=!1,t=!1){return function(r,u){let l=Reflect.get(r,u);return u===L.IS_REACTIVE?!e:u===L.IS_READONLY?e:(t||(m(l)&&(l=e?F(l):S(l)),e||ae(r,u)),l)}}function j(e=!1){return function(n,r,u){if(e)return console.warn(`${r} is readonly, target can not be set, ${n}`),!0;const l=Reflect.set(n,r,u);return pe(n,r),l}}const me={get:_e,set:he},$={get:Ee,set:Te},ve=T({},$,{get:Re});var L=(e=>(e.IS_REACTIVE="__v_isReactive__",e.IS_READONLY="__v_isReadonly__",e))(L||{});function S(e){return O(e,me)}function F(e){return O(e,$)}function Y(e){return!!e.__v_isReactive__}function U(e){return!!e.__v_isReadonly__}function ye(e){return Y(e)||U(e)}function z(e){return O(e,ve)}function O(e,t){return m(e)?new Proxy(e,t):(console.warn(`target ${e} is not a object`),e)}class be{constructor(t){_(this,"_value");_(this,"_rawValue");_(this,"deps");_(this,"_v_isRef",!0);this._rawValue=t,this._value=G(t),this.deps=new Set}get value(){return Ae(this),this._value}set value(t){x(t,this._rawValue)&&(this._rawValue=t,this._value=G(t),H(this.deps))}}function G(e){return m(e)?S(e):e}function Ae(e){P()&&D(e.deps)}function Ne(e){return new be(e)}function b(e){return!!e._v_isRef}function X(e){return b(e)?e.value:e}function V(e){return new Proxy(e,{get(t,n){return X(Reflect.get(t,n))},set(t,n,r){return b(t[n])&&!b(r)?t[n].value=r:Reflect.set(t,n,r)}})}function Ce(e,t){const n={isMounted:!1,vnode:e,type:e.type,setupState:{},props:{},emit:()=>{},emits:[],slots:{},provides:t?t.provides:{},parent:t,subTree:null};return n.emit=ce.bind(null,n),n}function Ie(e){p(e,e.vnode.props),ie(e,e.vnode.children),Le(e)}function Le(e){const t=e.type,{setup:n}=t;if(n){B(e);const r=n(z(e.props),{emit:e.emit});B(null),Se(e,r)}e.proxy=new Proxy({_:e},se)}function Se(e,t){typeof t=="object"&&(e.setupState=V(t)),Oe(e)}function Oe(e){const t=e.type;t.render&&(e.render=t.render)}let q=null;function w(){return q}function B(e){q=e}const J=Symbol("Fragment"),K=Symbol("Text");function y(e,t,n){const r={type:e,props:t,children:n,el:null,shapeFlag:ge(e)};return typeof n=="string"?r.shapeFlag|=h.TEXT_CHILDREN:Array.isArray(n)?r.shapeFlag|=h.ARRAY_CHILDREN:r.shapeFlag&h.STATEFUL_COMPONENT&&m(r.children)&&(r.shapeFlag|=h.SLOT_CHILDREN),r}function we(e){return y(K,{},e)}function ge(e){return typeof e=="string"?h.ELEMENT:h.STATEFUL_COMPONENT}function W(e){return function(n){return{mount(r){const u=y(n);let l;typeof r=="string"?l=document.querySelector(r):l=r,r||k(`can not find element ${r} on document`),e(u,l)}}}}function Me(e,t,n){return y(e,t,n)}function Pe(e,t,n){const r=e[t];if(r&&typeof r=="function")return y(J,{},r(n))}function De(e,t){var r;const n=w();if(n){let{provides:u}=n;const l=(r=n.parent)==null?void 0:r.provides;l===u&&(u=n.provides=Object.create(l)),u[e]=t}}function He(e,t){var r;const n=w();if(n){const u=(r=n.parent)==null?void 0:r.provides;if(u){if(e in u)return u[e];if(t)return typeof t=="function"?t():t}}}function Z(e){const{createElement:t,patchProp:n,insert:r}=e;function u(o,s){l(null,o,s,null)}const l=(o,s,f,i)=>{const{shapeFlag:a,type:d}=s;switch(d){case J:qe(o,s,f,i);break;case K:Ve(o,s,f);break;default:a&h.ELEMENT?Ke(o,s,f,i):a&h.STATEFUL_COMPONENT&&Ze(o,s,f,i);break}},Ve=(o,s,f)=>{const{children:i}=s,a=s.el=document.createTextNode(i);f.append(a)},qe=(o,s,f,i)=>{Q(s,f,i)};function Be(o,s,f){if(s!==f){for(const i in f){const a=s[i],d=f[i];a!==d&&n(o,i,a,d)}if(s!==A)for(const i in s)i in f||n(o,i,s[i],null)}}function Je(o,s,f){const i=o.props||A,a=s.props||A,d=s.el=o.el;Be(d,i,a)}function Ke(o,s,f,i){o?Je(o,s):We(s,f,i)}function We(o,s,f){const{children:i,props:a,shapeFlag:d}=o,E=t(o.type);o.el=E,i&&(d&h.TEXT_CHILDREN?E.textContent=i:d&h.ARRAY_CHILDREN&&Q(o,E,f));for(const R in a){const ke=a[R];n(E,R,null,ke)}r(E,s)}function Q(o,s,f){o.children.forEach(i=>{l(null,i,s,f)})}function Ze(o,s,f,i){Qe(s,f,i)}function Qe(o,s,f){const i=Ce(o,f);Ie(i),xe(i,o,s)}function xe(o,s,f){de(()=>{var i,a;if(o.isMounted){const{proxy:d}=o,E=o.subTree,R=(a=o.render)==null?void 0:a.call(d);o.subTree=R||null,R&&l(E,R,f,o),s.el=R.el,o.isMounted=!0}else{const{proxy:d}=o;o.subTree=((i=o.render)==null?void 0:i.call(d))||null;const E=o.subTree;E&&l(null,E,f,o),s.el=E.el,o.isMounted=!0}})}return{createApp:W(u)}}function je(e){return document.createElement(e)}function $e(e,t,n,r){if(ee(t)){const u=t.slice(2).toLowerCase();e.addEventListener(u,r)}else r==null?e.removeAttribute(t):e.setAttribute(t,r)}function Fe(e,t){t.appendChild(e)}const Ye=Z({createElement:je,patchProp:$e,insert:Fe});function Ue(e){return Ye.createApp(e)}class ze{constructor(t){_(this,"_getter");_(this,"_isDirty",!0);_(this,"_value");_(this,"_effect");this._getter=t,this._effect=new M(t,()=>{this._isDirty||(this._isDirty=!0)})}get value(){return this._isDirty&&(this._isDirty=!1,this._value=this._effect.run()),this._value}}function Ge(e){return new ze(e)}function Xe(e,t){return e+t}c.add=Xe,c.computed=Ge,c.createApp=Ue,c.createAppAPI=W,c.createRender=Z,c.createTextNode=we,c.createVNode=y,c.getCurrentInstance=w,c.h=Me,c.inject=He,c.isProxy=ye,c.isReactive=Y,c.isReadonly=U,c.isRef=b,c.provide=De,c.proxyRefs=V,c.reactive=S,c.readonly=F,c.ref=Ne,c.renderSlots=Pe,c.shallowReadonly=z,c.unRef=X,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
